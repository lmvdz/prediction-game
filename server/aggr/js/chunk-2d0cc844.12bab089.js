(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cc844"],{"4dec":function(e,n,t){"use strict";t.r(n),t.d(n,"Dexie",(function(){return Lr})),t.d(n,"RangeSet",(function(){return jr})),t.d(n,"default",(function(){return Lr})),t.d(n,"liveQuery",(function(){return Yr})),t.d(n,"mergeRanges",(function(){return Dr})),t.d(n,"rangesOverlap",(function(){return Br}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(){return r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},r.apply(this,arguments)};function i(e,n,t){if(t||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var o="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,u=Object.keys,a=Array.isArray;function s(e,n){return"object"!==typeof n||u(n).forEach((function(t){e[t]=n[t]})),e}"undefined"===typeof Promise||o.Promise||(o.Promise=Promise);var c=Object.getPrototypeOf,l={}.hasOwnProperty;function f(e,n){return l.call(e,n)}function h(e,n){"function"===typeof n&&(n=n(c(e))),("undefined"===typeof Reflect?u:Reflect.ownKeys)(n).forEach((function(t){p(e,t,n[t])}))}var d=Object.defineProperty;function p(e,n,t,r){d(e,n,s(t&&f(t,"get")&&"function"===typeof t.get?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function y(e){return{from:function(n){return e.prototype=Object.create(n.prototype),p(e.prototype,"constructor",e),{extend:h.bind(null,e.prototype)}}}}var v=Object.getOwnPropertyDescriptor;function m(e,n){var t,r=v(e,n);return r||(t=c(e))&&m(t,n)}var g=[].slice;function b(e,n,t){return g.call(e,n,t)}function _(e,n){return n(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function x(e){o.setImmediate?setImmediate(e):setTimeout(e,0)}function k(e,n){return e.reduce((function(e,t,r){var i=n(t,r);return i&&(e[i[0]]=i[1]),e}),{})}function E(e,n,t){try{e.apply(null,t)}catch(r){n&&n(r)}}function P(e,n){if(f(e,n))return e[n];if(!n)return e;if("string"!==typeof n){for(var t=[],r=0,i=n.length;r<i;++r){var o=P(e,n[r]);t.push(o)}return t}var u=n.indexOf(".");if(-1!==u){var a=e[n.substr(0,u)];return void 0===a?void 0:P(a,n.substr(u+1))}}function K(e,n,t){if(e&&void 0!==n&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!==typeof n&&"length"in n){w("string"!==typeof t&&"length"in t);for(var r=0,i=n.length;r<i;++r)K(e,n[r],t[r])}else{var o=n.indexOf(".");if(-1!==o){var u=n.substr(0,o),s=n.substr(o+1);if(""===s)void 0===t?a(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=t;else{var c=e[u];c&&f(e,u)||(c=e[u]={}),K(c,s,t)}}else void 0===t?a(e)&&!isNaN(parseInt(n))?e.splice(n,1):delete e[n]:e[n]=t}}function O(e,n){"string"===typeof n?K(e,n,void 0):"length"in n&&[].map.call(n,(function(n){K(e,n,void 0)}))}function S(e){var n={};for(var t in e)f(e,t)&&(n[t]=e[t]);return n}var A=[].concat;function C(e){return A.apply([],e)}var j="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(C([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(n){return n+e+"Array"}))})))).filter((function(e){return o[e]})),I=j.map((function(e){return o[e]}));k(j,(function(e){return[e,!0]}));var D=null;function B(e){D="undefined"!==typeof WeakMap&&new WeakMap;var n=T(e);return D=null,n}function T(e){if(!e||"object"!==typeof e)return e;var n=D&&D.get(e);if(n)return n;if(a(e)){n=[],D&&D.set(e,n);for(var t=0,r=e.length;t<r;++t)n.push(T(e[t]))}else if(I.indexOf(e.constructor)>=0)n=e;else{var i=c(e);for(var o in n=i===Object.prototype?{}:Object.create(i),D&&D.set(e,n),e)f(e,o)&&(n[o]=T(e[o]))}return n}var R={}.toString;function F(e){return R.call(e).slice(8,-1)}var M="undefined"!==typeof Symbol?Symbol.iterator:"@@iterator",N="symbol"===typeof M?function(e){var n;return null!=e&&(n=e[M])&&n.apply(e)}:function(){return null},q={};function L(e){var n,t,r,i;if(1===arguments.length){if(a(e))return e.slice();if(this===q&&"string"===typeof e)return[e];if(i=N(e)){t=[];while(r=i.next(),!r.done)t.push(r.value);return t}if(null==e)return[e];if(n=e.length,"number"===typeof n){t=new Array(n);while(n--)t[n]=e[n];return t}return[e]}n=arguments.length,t=new Array(n);while(n--)t[n]=arguments[n];return t}var U="undefined"!==typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},V="undefined"!==typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function W(e,n){V=e,Y=n}var Y=function(){return!0},z=!new Error("").stack;function G(){if(z)try{throw G.arguments,new Error}catch(e){return e}return new Error}function H(e,n){var t=e.stack;return t?(n=n||0,0===t.indexOf(e.name)&&(n+=(e.name+e.message).split("\n").length),t.split("\n").slice(n).filter(Y).map((function(e){return"\n"+e})).join("")):""}var Q=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],X=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],J=Q.concat(X),$={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Z(e,n){this._e=G(),this.name=e,this.message=n}function ee(e,n){return e+". Errors: "+Object.keys(n).map((function(e){return n[e].toString()})).filter((function(e,n,t){return t.indexOf(e)===n})).join("\n")}function ne(e,n,t,r){this._e=G(),this.failures=n,this.failedKeys=r,this.successCount=t,this.message=ee(e,n)}function te(e,n){this._e=G(),this.name="BulkError",this.failures=Object.keys(n).map((function(e){return n[e]})),this.failuresByPos=n,this.message=ee(e,n)}y(Z).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+H(this._e,2))}},toString:function(){return this.name+": "+this.message}}),y(ne).from(Z),y(te).from(Z);var re=J.reduce((function(e,n){return e[n]=n+"Error",e}),{}),ie=Z,oe=J.reduce((function(e,n){var t=n+"Error";function r(e,r){this._e=G(),this.name=t,e?"string"===typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"===typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=$[n]||t,this.inner=null)}return y(r).from(ie),e[n]=r,e}),{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var ue=X.reduce((function(e,n){return e[n+"Error"]=oe[n],e}),{});function ae(e,n){if(!e||e instanceof Z||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ue[e.name])return e;var t=new ue[e.name](n||e.message,e);return"stack"in e&&p(t,"stack",{get:function(){return this.inner.stack}}),t}var se=J.reduce((function(e,n){return-1===["Syntax","Type","Range"].indexOf(n)&&(e[n+"Error"]=oe[n]),e}),{});function ce(){}function le(e){return e}function fe(e,n){return null==e||e===le?n:function(t){return n(e(t))}}function he(e,n){return function(){e.apply(this,arguments),n.apply(this,arguments)}}function de(e,n){return e===ce?n:function(){var t=e.apply(this,arguments);void 0!==t&&(arguments[0]=t);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=n.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?he(r,this.onsuccess):r),i&&(this.onerror=this.onerror?he(i,this.onerror):i),void 0!==o?o:t}}function pe(e,n){return e===ce?n:function(){e.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?he(t,this.onsuccess):t),r&&(this.onerror=this.onerror?he(r,this.onerror):r)}}function ye(e,n){return e===ce?n:function(t){var r=e.apply(this,arguments);s(t,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var u=n.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?he(i,this.onsuccess):i),o&&(this.onerror=this.onerror?he(o,this.onerror):o),void 0===r?void 0===u?void 0:u:s(r,u)}}function ve(e,n){return e===ce?n:function(){return!1!==n.apply(this,arguments)&&e.apply(this,arguments)}}function me(e,n){return e===ce?n:function(){var t=e.apply(this,arguments);if(t&&"function"===typeof t.then){var r=this,i=arguments.length,o=new Array(i);while(i--)o[i]=arguments[i];return t.then((function(){return n.apply(r,o)}))}return n.apply(this,arguments)}}se.ModifyError=ne,se.DexieError=Z,se.BulkError=te;var ge={},be=100,_e=20,we=100,xe="undefined"===typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"===typeof crypto||!crypto.subtle)return[e,c(e),e];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,c(n),e]}(),ke=xe[0],Ee=xe[1],Pe=xe[2],Ke=Ee&&Ee.then,Oe=ke&&ke.constructor,Se=!!Pe,Ae=!1,Ce=Pe?function(){Pe.then(Ze)}:o.setImmediate?setImmediate.bind(null,Ze):o.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Ze(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Ze,0)},je=function(e,n){qe.push([e,n]),De&&(Ce(),De=!1)},Ie=!0,De=!0,Be=[],Te=[],Re=null,Fe=le,Me={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Sn,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{Sn(e[0],e[1])}catch(n){}}))}},Ne=Me,qe=[],Le=0,Ue=[];function Ve(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ce,this._lib=!1;var n=this._PSD=Ne;if(V&&(this._stackHolder=G(),this._prev=null,this._numPrev=0),"function"!==typeof e){if(e!==ge)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ge(this,this._value))}this._state=null,this._value=null,++n.ref,ze(this,e)}var We={get:function(){var e=Ne,n=dn;function t(t,r){var i=this,o=!e.global&&(e!==Ne||n!==dn),u=o&&!mn(),a=new Ve((function(n,a){Qe(i,new Ye(Pn(t,e,o,u),Pn(r,e,o,u),n,a,e))}));return V&&$e(a,this),a}return t.prototype=ge,t},set:function(e){p(this,"then",e&&e.prototype===ge?We:{get:function(){return e},set:We.set})}};function Ye(e,n,t,r,i){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof n?n:null,this.resolve=t,this.reject=r,this.psd=i}function ze(e,n){try{n((function(n){if(null===e._state){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var t=e._lib&&en();n&&"function"===typeof n.then?ze(e,(function(e,t){n instanceof Ve?n._then(e,t):n.then(e,t)})):(e._state=!0,e._value=n,He(e)),t&&nn()}}),Ge.bind(null,e))}catch(t){Ge(e,t)}}function Ge(e,n){if(Te.push(n),null===e._state){var t=e._lib&&en();n=Fe(n),e._state=!1,e._value=n,V&&null!==n&&"object"===typeof n&&!n._promise&&E((function(){var t=m(n,"stack");n._promise=e,p(n,"stack",{get:function(){return Ae?t&&(t.get?t.get.apply(n):t.value):e.stack}})})),on(e),He(e),t&&nn()}}function He(e){var n=e._listeners;e._listeners=[];for(var t=0,r=n.length;t<r;++t)Qe(e,n[t]);var i=e._PSD;--i.ref||i.finalize(),0===Le&&(++Le,je((function(){0===--Le&&tn()}),[]))}function Qe(e,n){if(null!==e._state){var t=e._state?n.onFulfilled:n.onRejected;if(null===t)return(e._state?n.resolve:n.reject)(e._value);++n.psd.ref,++Le,je(Xe,[t,e,n])}else e._listeners.push(n)}function Xe(e,n,t){try{Re=n;var r,i=n._value;n._state?r=e(i):(Te.length&&(Te=[]),r=e(i),-1===Te.indexOf(i)&&un(n)),t.resolve(r)}catch(o){t.reject(o)}finally{Re=null,0===--Le&&tn(),--t.psd.ref||t.psd.finalize()}}function Je(e,n,t){if(n.length===t)return n;var r="";if(!1===e._state){var i,o,u=e._value;null!=u?(i=u.name||"Error",o=u.message||u,r=H(u,0)):(i=u,o=""),n.push(i+(o?": "+o:"")+r)}return V&&(r=H(e._stackHolder,2),r&&-1===n.indexOf(r)&&n.push(r),e._prev&&Je(e._prev,n,t)),n}function $e(e,n){var t=n?n._numPrev+1:0;t<be&&(e._prev=n,e._numPrev=t)}function Ze(){en()&&nn()}function en(){var e=Ie;return Ie=!1,De=!1,e}function nn(){var e,n,t;do{while(qe.length>0)for(e=qe,qe=[],t=e.length,n=0;n<t;++n){var r=e[n];r[0].apply(null,r[1])}}while(qe.length>0);Ie=!0,De=!0}function tn(){var e=Be;Be=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));var n=Ue.slice(0),t=n.length;while(t)n[--t]()}function rn(e){function n(){e(),Ue.splice(Ue.indexOf(n),1)}Ue.push(n),++Le,je((function(){0===--Le&&tn()}),[])}function on(e){Be.some((function(n){return n._value===e._value}))||Be.push(e)}function un(e){var n=Be.length;while(n)if(Be[--n]._value===e._value)return void Be.splice(n,1)}function an(e){return new Ve(ge,!1,e)}function sn(e,n){var t=Ne;return function(){var r=en(),i=Ne;try{return wn(t,!0),e.apply(this,arguments)}catch(o){n&&n(o)}finally{wn(i,!1),r&&nn()}}}h(Ve.prototype,{then:We,_then:function(e,n){Qe(this,new Ye(null,null,e,n,Ne))},catch:function(e){if(1===arguments.length)return this.then(null,e);var n=arguments[0],t=arguments[1];return"function"===typeof n?this.then(null,(function(e){return e instanceof n?t(e):an(e)})):this.then(null,(function(e){return e&&e.name===n?t(e):an(e)}))},finally:function(e){return this.then((function(n){return e(),n}),(function(n){return e(),an(n)}))},stack:{get:function(){if(this._stack)return this._stack;try{Ae=!0;var e=Je(this,[],_e),n=e.join("\nFrom previous: ");return null!==this._state&&(this._stack=n),n}finally{Ae=!1}}},timeout:function(e,n){var t=this;return e<1/0?new Ve((function(r,i){var o=setTimeout((function(){return i(new oe.Timeout(n))}),e);t.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!==typeof Symbol&&Symbol.toStringTag&&p(Ve.prototype,Symbol.toStringTag,"Dexie.Promise"),Me.env=xn(),h(Ve,{all:function(){var e=L.apply(null,arguments).map(gn);return new Ve((function(n,t){0===e.length&&n([]);var r=e.length;e.forEach((function(i,o){return Ve.resolve(i).then((function(t){e[o]=t,--r||n(e)}),t)}))}))},resolve:function(e){if(e instanceof Ve)return e;if(e&&"function"===typeof e.then)return new Ve((function(n,t){e.then(n,t)}));var n=new Ve(ge,!0,e);return $e(n,Re),n},reject:an,race:function(){var e=L.apply(null,arguments).map(gn);return new Ve((function(n,t){e.map((function(e){return Ve.resolve(e).then(n,t)}))}))},PSD:{get:function(){return Ne},set:function(e){return Ne=e}},totalEchoes:{get:function(){return dn}},newPSD:yn,usePSD:kn,scheduler:{get:function(){return je},set:function(e){je=e}},rejectionMapper:{get:function(){return Fe},set:function(e){Fe=e}},follow:function(e,n){return new Ve((function(t,r){return yn((function(n,t){var r=Ne;r.unhandleds=[],r.onunhandled=t,r.finalize=he((function(){var e=this;rn((function(){0===e.unhandleds.length?n():t(e.unhandleds[0])}))}),r.finalize),e()}),n,t,r)}))}}),Oe&&(Oe.allSettled&&p(Ve,"allSettled",(function(){var e=L.apply(null,arguments).map(gn);return new Ve((function(n){0===e.length&&n([]);var t=e.length,r=new Array(t);e.forEach((function(e,i){return Ve.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--t||n(r)}))}))}))})),Oe.any&&"undefined"!==typeof AggregateError&&p(Ve,"any",(function(){var e=L.apply(null,arguments).map(gn);return new Ve((function(n,t){0===e.length&&t(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Ve.resolve(e).then((function(e){return n(e)}),(function(e){i[o]=e,--r||t(new AggregateError(i))}))}))}))})));var cn={awaits:0,echoes:0,id:0},ln=0,fn=[],hn=0,dn=0,pn=0;function yn(e,n,t,r){var i=Ne,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++pn;var u=Me.env;o.env=Se?{Promise:Ve,PromiseProp:{value:Ve,configurable:!0,writable:!0},all:Ve.all,race:Ve.race,allSettled:Ve.allSettled,any:Ve.any,resolve:Ve.resolve,reject:Ve.reject,nthen:Kn(u.nthen,o),gthen:Kn(u.gthen,o)}:{},n&&s(o,n),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=kn(o,e,t,r);return 0===o.ref&&o.finalize(),a}function vn(){return cn.id||(cn.id=++ln),++cn.awaits,cn.echoes+=we,cn.id}function mn(){return!!cn.awaits&&(0===--cn.awaits&&(cn.id=0),cn.echoes=cn.awaits*we,!0)}function gn(e){return cn.echoes&&e&&e.constructor===Oe?(vn(),e.then((function(e){return mn(),e}),(function(e){return mn(),An(e)}))):e}function bn(e){++dn,cn.echoes&&0!==--cn.echoes||(cn.echoes=cn.id=0),fn.push(Ne),wn(e,!0)}function _n(){var e=fn[fn.length-1];fn.pop(),wn(e,!1)}function wn(e,n){var t=Ne;if((n?!cn.echoes||hn++&&e===Ne:!hn||--hn&&e===Ne)||En(n?bn.bind(null,e):_n),e!==Ne&&(Ne=e,t===Me&&(Me.env=xn()),Se)){var r=Me.env.Promise,i=e.env;Ee.then=i.nthen,r.prototype.then=i.gthen,(t.global||e.global)&&(Object.defineProperty(o,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function xn(){var e=o.Promise;return Se?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Ee.then,gthen:e.prototype.then}:{}}function kn(e,n,t,r,i){var o=Ne;try{return wn(e,!0),n(t,r,i)}finally{wn(o,!1)}}function En(e){Ke.call(ke,e)}function Pn(e,n,t,r){return"function"!==typeof e?e:function(){var i=Ne;t&&vn(),wn(n,!0);try{return e.apply(this,arguments)}finally{wn(i,!1),r&&En(mn)}}}function Kn(e,n){return function(t,r){return e.call(this,Pn(t,n),Pn(r,n))}}-1===(""+Ke).indexOf("[native code]")&&(vn=mn=ce);var On="unhandledrejection";function Sn(e,n){var t;try{t=n.onuncatched(e)}catch(u){}if(!1!==t)try{var r,i={promise:n,reason:e};if(o.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(On,!0,!0),s(r,i)):o.CustomEvent&&(r=new CustomEvent(On,{detail:i}),s(r,i)),r&&o.dispatchEvent&&(dispatchEvent(r),!o.PromiseRejectionEvent&&o.onunhandledrejection))try{o.onunhandledrejection(r)}catch(a){}V&&r&&r.defaultPrevented}catch(u){}}var An=Ve.reject;function Cn(e,n,t,r){if(e.idbdb&&(e._state.openComplete||Ne.letThrough||e._vip)){var i=e._createTransaction(n,t,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===re.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(e._close(),e.open().then((function(){return Cn(e,n,t,r)}))):An(o)}return i._promise(n,(function(e,n){return yn((function(){return Ne.trans=i,r(e,n,i)}))})).then((function(e){return i._completion.then((function(){return e}))}))}if(e._state.openComplete)return An(new oe.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return An(new oe.DatabaseClosed);e.open().catch(ce)}return e._state.dbReadyPromise.then((function(){return Cn(e,n,t,r)}))}var jn="3.2.2",In=String.fromCharCode(65535),Dn=-1/0,Bn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Tn="String expected.",Rn=[],Fn="undefined"!==typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Mn=Fn,Nn=Fn,qn=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},Ln="__dbnames",Un="readonly",Vn="readwrite";function Wn(e,n){return e?n?function(){return e.apply(this,arguments)&&n.apply(this,arguments)}:e:n}var Yn={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function zn(e){return"string"!==typeof e||/\./.test(e)?function(e){return e}:function(n){return void 0===n[e]&&e in n&&(n=B(n),delete n[e]),n}}var Gn=function(){function e(){}return e.prototype._trans=function(e,n,t){var r=this._tx||Ne.trans,i=this.name;function o(e,t,r){if(!r.schema[i])throw new oe.NotFound("Table "+i+" not part of transaction");return n(r.idbtrans,r)}var u=en();try{return r&&r.db===this.db?r===Ne.trans?r._promise(e,o,t):yn((function(){return r._promise(e,o,t)}),{trans:r,transless:Ne.transless||Ne}):Cn(this.db,e,[this.name],o)}finally{u&&nn()}},e.prototype.get=function(e,n){var t=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",(function(n){return t.core.get({trans:n,key:e}).then((function(e){return t.hook.reading.fire(e)}))})).then(n)},e.prototype.where=function(e){if("string"===typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=u(e);if(1===n.length)return this.where(n[0]).equals(e[n[0]]);var t=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&n.every((function(n){return e.keyPath.indexOf(n)>=0}))&&e.keyPath.every((function(e){return n.indexOf(e)>=0}))}))[0];if(t&&this.db._maxKey!==In)return this.where(t.name).equals(t.keyPath.map((function(n){return e[n]})));var r=this.schema.idxByName,i=this.db._deps.indexedDB;function o(e,n){try{return 0===i.cmp(e,n)}catch(t){return!1}}var s=n.reduce((function(n,t){var i=n[0],u=n[1],s=r[t],c=e[t];return[i||s,i||!s?Wn(u,s&&s.multi?function(e){var n=P(e,t);return a(n)&&n.some((function(e){return o(c,e)}))}:function(e){return o(c,P(e,t))}):u]}),[null,null]),c=s[0],l=s[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(l):t?this.filter(l):this.where(n).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(n){if(!n)return n;var t=Object.create(e.prototype);for(var r in n)if(f(n,r))try{t[r]=n[r]}catch(i){}return t};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},e.prototype.defineClass=function(){function e(e){s(this,e)}return this.mapToClass(e)},e.prototype.add=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=zn(o)(e)),this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"add",keys:null!=n?[n]:null,values:[u]})})).then((function(e){return e.numFailures?Ve.reject(e.failures[0]):e.lastResult})).then((function(n){if(o)try{K(e,o,n)}catch(t){}return n}))},e.prototype.update=function(e,n){if("object"!==typeof e||a(e))return this.where(":id").equals(e).modify(n);var t=P(e,this.schema.primKey.keyPath);if(void 0===t)return An(new oe.InvalidArgument("Given object does not contain its primary key"));try{"function"!==typeof n?u(n).forEach((function(t){K(e,t,n[t])})):n(e,{value:e,primKey:t})}catch(Sr){}return this.where(":id").equals(t).modify(n)},e.prototype.put=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=zn(o)(e)),this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"put",values:[u],keys:null!=n?[n]:null})})).then((function(e){return e.numFailures?Ve.reject(e.failures[0]):e.lastResult})).then((function(n){if(o)try{K(e,o,n)}catch(t){}return n}))},e.prototype.delete=function(e){var n=this;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Ve.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(n){return e.core.mutate({trans:n,type:"deleteRange",range:Yn})})).then((function(e){return e.numFailures?Ve.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",(function(t){return n.core.getMany({keys:e,trans:t}).then((function(e){return e.map((function(e){return n.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0;t=t||(i?void 0:n);var o=t?t.allKeys:void 0;return this._trans("readwrite",(function(n){var t=r.schema.primKey,u=t.auto,a=t.keyPath;if(a&&i)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=a&&u?e.map(zn(a)):e;return r.core.mutate({trans:n,type:"add",keys:i,values:c,wantResults:o}).then((function(e){var n=e.numFailures,t=e.results,i=e.lastResult,u=e.failures,a=o?t:i;if(0===n)return a;throw new te(r.name+".bulkAdd(): "+n+" of "+s+" operations failed",u)}))}))},e.prototype.bulkPut=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0;t=t||(i?void 0:n);var o=t?t.allKeys:void 0;return this._trans("readwrite",(function(n){var t=r.schema.primKey,u=t.auto,a=t.keyPath;if(a&&i)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=a&&u?e.map(zn(a)):e;return r.core.mutate({trans:n,type:"put",keys:i,values:c,wantResults:o}).then((function(e){var n=e.numFailures,t=e.results,i=e.lastResult,u=e.failures,a=o?t:i;if(0===n)return a;throw new te(r.name+".bulkPut(): "+n+" of "+s+" operations failed",u)}))}))},e.prototype.bulkDelete=function(e){var n=this,t=e.length;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new te(n.name+".bulkDelete(): "+r+" of "+t+" operations failed",o)}))},e}();function Hn(e){var n={},t=function(t,r){if(r){var i=arguments.length,o=new Array(i-1);while(--i)o[i-1]=arguments[i];return n[t].subscribe.apply(null,o),e}if("string"===typeof t)return n[t]};t.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return t;function o(e,r,i){if("object"===typeof e)return s(e);r||(r=ve),i||(i=ce);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(n){return n!==e})),o.fire=o.subscribers.reduce(r,i)}};return n[e]=t[e]=o,o}function s(e){u(e).forEach((function(n){var t=e[n];if(a(t))o(n,e[n][0],e[n][1]);else{if("asap"!==t)throw new oe.InvalidArgument("Invalid event config");var r=o(n,le,(function(){var e=arguments.length,n=new Array(e);while(e--)n[e]=arguments[e];r.subscribers.forEach((function(e){x((function(){e.apply(null,n)}))}))}))}}))}}function Qn(e,n){return y(n).from({prototype:e}),n}function Xn(e){return Qn(Gn.prototype,(function(n,t,r){this.db=e,this._tx=r,this.name=n,this.schema=t,this.hook=e._allTables[n]?e._allTables[n].hook:Hn(null,{creating:[de,ce],reading:[fe,le],updating:[ye,ce],deleting:[pe,ce]})}))}function Jn(e,n){return!(e.filter||e.algorithm||e.or)&&(n?e.justLimit:!e.replayFilter)}function $n(e,n){e.filter=Wn(e.filter,n)}function Zn(e,n,t){var r=e.replayFilter;e.replayFilter=r?function(){return Wn(r(),n())}:n,e.justLimit=t&&!r}function et(e,n){e.isMatch=Wn(e.isMatch,n)}function nt(e,n){if(e.isPrimKey)return n.primaryKey;var t=n.getIndexByKeyPath(e.index);if(!t)throw new oe.Schema("KeyPath "+e.index+" on object store "+n.name+" is not indexed");return t}function tt(e,n,t){var r=nt(e,n.schema);return n.openCursor({trans:t,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function rt(e,n,t,r){var i=e.replayFilter?Wn(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},u=function(e,t,r){if(!i||i(t,r,(function(e){return t.stop(e)}),(function(e){return t.fail(e)}))){var u=t.primaryKey,a=""+u;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(u)),f(o,a)||(o[a]=!0,n(e,t,r))}};return Promise.all([e.or._iterate(u,t),it(tt(e,r,t),e.algorithm,u,!e.keysOnly&&e.valueMapper)])}return it(tt(e,r,t),Wn(e.algorithm,i),n,!e.keysOnly&&e.valueMapper)}function it(e,n,t,r){var i=r?function(e,n,i){return t(r(e),n,i)}:t,o=sn(i);return e.then((function(e){if(e)return e.start((function(){var t=function(){return e.continue()};n&&!n(e,(function(e){return t=e}),(function(n){e.stop(n),t=ce}),(function(n){e.fail(n),t=ce}))||o(e.value,e,(function(e){return t=e})),t()}))}))}function ot(e,n){try{var t=st(e),r=st(n);if(t!==r)return"Array"===t?1:"Array"===r?-1:"binary"===t?1:"binary"===r?-1:"string"===t?1:"string"===r?-1:"Date"===t?1:"Date"!==r?NaN:-1;switch(t){case"number":case"Date":case"string":return e>n?1:e<n?-1:0;case"binary":return at(ct(e),ct(n));case"Array":return ut(e,n)}}catch(Sr){}return NaN}function ut(e,n){for(var t=e.length,r=n.length,i=t<r?t:r,o=0;o<i;++o){var u=ot(e[o],n[o]);if(0!==u)return u}return t===r?0:t<r?-1:1}function at(e,n){for(var t=e.length,r=n.length,i=t<r?t:r,o=0;o<i;++o)if(e[o]!==n[o])return e[o]<n[o]?-1:1;return t===r?0:t<r?-1:1}function st(e){var n=typeof e;if("object"!==n)return n;if(ArrayBuffer.isView(e))return"binary";var t=F(e);return"ArrayBuffer"===t?"binary":t}function ct(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var lt=function(){function e(){}return e.prototype._read=function(e,n){var t=this._ctx;return t.error?t.table._trans(null,An.bind(null,t.error)):t.table._trans("readonly",e).then(n)},e.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,An.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Wn(n.algorithm,e)},e.prototype._iterate=function(e,n){return rt(this._ctx,e,n,this._ctx.table.core)},e.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),t=Object.create(this._ctx);return e&&s(t,e),n._ctx=t,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var n=this._ctx;return this._read((function(t){return rt(n,e,t,n.table.core)}))},e.prototype.count=function(e){var n=this;return this._read((function(e){var t=n._ctx,r=t.table.core;if(Jn(t,!0))return r.count({trans:e,query:{index:nt(t,r.schema),range:t.range}}).then((function(e){return Math.min(e,t.limit)}));var i=0;return rt(t,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,n){var t=e.split(".").reverse(),r=t[0],i=t.length-1;function o(e,n){return n?o(e[t[n]],n-1):e[r]}var u="next"===this._ctx.dir?1:-1;function a(e,n){var t=o(e,i),r=o(n,i);return t<r?-u:t>r?u:0}return this.toArray((function(e){return e.sort(a)})).then(n)},e.prototype.toArray=function(e){var n=this;return this._read((function(e){var t=n._ctx;if("next"===t.dir&&Jn(t,!0)&&t.limit>0){var r=t.valueMapper,i=nt(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:i,range:t.range}}).then((function(e){var n=e.result;return r?n.map(r):n}))}var o=[];return rt(t,(function(e){return o.push(e)}),e,t.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var n=this._ctx;return e<=0||(n.offset+=e,Jn(n)?Zn(n,(function(){var n=e;return function(e,t){return 0===n||(1===n?(--n,!1):(t((function(){e.advance(n),n=0})),!1))}})):Zn(n,(function(){var n=e;return function(){return--n<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Zn(this._ctx,(function(){var n=e;return function(e,t,r){return--n<=0&&t(r),n>=0}}),!0),this},e.prototype.until=function(e,n){return $n(this._ctx,(function(t,r,i){return!e(t.value)||(r(i),n)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return $n(this._ctx,(function(n){return e(n.value)})),et(this._ctx,e),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each((function(n,t){e(t.key,t)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each((function(n,t){e(t.primaryKey,t)}))},e.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var t=[];return this.each((function(e,n){t.push(n.key)})).then((function(){return t})).then(e)},e.prototype.primaryKeys=function(e){var n=this._ctx;if("next"===n.dir&&Jn(n,!0)&&n.limit>0)return this._read((function(e){var t=nt(n,n.table.core.schema);return n.table.core.query({trans:e,values:!1,limit:n.limit,query:{index:t,range:n.range}})})).then((function(e){var n=e.result;return n})).then(e);n.keysOnly=!n.isMatch;var t=[];return this.each((function(e,n){t.push(n.primaryKey)})).then((function(){return t})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var t={};return $n(this._ctx,(function(e){var n=e.primaryKey.toString(),r=f(t,n);return t[n]=!0,!r})),this},e.prototype.modify=function(e){var n=this,t=this._ctx;return this._write((function(r){var i;if("function"===typeof e)i=e;else{var o=u(e),a=o.length;i=function(n){for(var t=!1,r=0;r<a;++r){var i=o[r],u=e[i];P(n,i)!==u&&(K(n,i,u),t=!0)}return t}}var s=t.table.core,c=s.schema.primaryKey,l=c.outbound,f=c.extractKey,h=n.db._options.modifyChunkSize||200,d=[],p=0,y=[],v=function(e,n){var t=n.failures,r=n.numFailures;p+=e-r;for(var i=0,o=u(t);i<o.length;i++){var a=o[i];d.push(t[a])}};return n.clone().primaryKeys().then((function(n){var o=function(u){var a=Math.min(h,n.length-u);return s.getMany({trans:r,keys:n.slice(u,u+a),cache:"immutable"}).then((function(c){for(var d=[],p=[],y=l?[]:null,m=[],g=0;g<a;++g){var b=c[g],_={value:B(b),primKey:n[u+g]};!1!==i.call(_,_.value,_)&&(null==_.value?m.push(n[u+g]):l||0===ot(f(b),f(_.value))?(p.push(_.value),l&&y.push(n[u+g])):(m.push(n[u+g]),d.push(_.value)))}var w=Jn(t)&&t.limit===1/0&&("function"!==typeof e||e===ft)&&{index:t.index,range:t.range};return Promise.resolve(d.length>0&&s.mutate({trans:r,type:"add",values:d}).then((function(e){for(var n in e.failures)m.splice(parseInt(n),1);v(d.length,e)}))).then((function(){return(p.length>0||w&&"object"===typeof e)&&s.mutate({trans:r,type:"put",keys:y,values:p,criteria:w,changeSpec:"function"!==typeof e&&e}).then((function(e){return v(p.length,e)}))})).then((function(){return(m.length>0||w&&e===ft)&&s.mutate({trans:r,type:"delete",keys:m,criteria:w}).then((function(e){return v(m.length,e)}))})).then((function(){return n.length>u+a&&o(u+h)}))}))};return o(0).then((function(){if(d.length>0)throw new ne("Error modifying one or more objects",d,p,y);return n.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,n=e.range;return Jn(e)&&(e.isPrimKey&&!Nn||3===n.type)?this._write((function(t){var r=e.table.core.schema.primaryKey,i=n;return e.table.core.count({trans:t,query:{index:r,range:i}}).then((function(n){return e.table.core.mutate({trans:t,type:"deleteRange",range:i}).then((function(e){var t=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new ne("Could not delete some values",Object.keys(t).map((function(e){return t[e]})),n-r);return n-r}))}))})):this.modify(ft)},e}(),ft=function(e,n){return n.value=null};function ht(e){return Qn(lt.prototype,(function(n,t){this.db=e;var r=Yn,i=null;if(t)try{r=t()}catch(s){i=s}var o=n._ctx,u=o.table,a=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:a!==le?a:null}}))}function dt(e,n){return e<n?-1:e===n?0:1}function pt(e,n){return e>n?-1:e===n?0:1}function yt(e,n,t){var r=e instanceof kt?new e.Collection(e):e;return r._ctx.error=t?new t(n):new TypeError(n),r}function vt(e){return new e.Collection(e,(function(){return xt("")})).limit(0)}function mt(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function gt(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function bt(e,n,t,r,i,o){for(var u=Math.min(e.length,r.length),a=-1,s=0;s<u;++s){var c=n[s];if(c!==r[s])return i(e[s],t[s])<0?e.substr(0,s)+t[s]+t.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+t.substr(s+1):a>=0?e.substr(0,a)+n[a]+t.substr(a+1):null;i(e[s],c)<0&&(a=s)}return u<r.length&&"next"===o?e+t.substr(e.length):u<e.length&&"prev"===o?e.substr(0,t.length):a<0?null:e.substr(0,a)+r[a]+t.substr(a+1)}function _t(e,n,t,r){var i,o,u,a,s,c,l,f=t.length;if(!t.every((function(e){return"string"===typeof e})))return yt(e,Tn);function h(e){i=mt(e),o=gt(e),u="next"===e?dt:pt;var n=t.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,n){return u(e.lower,n.lower)}));a=n.map((function(e){return e.upper})),s=n.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var d=new e.Collection(e,(function(){return wt(a[0],s[f-1]+r)}));d._ondirectionchange=function(e){h(e)};var p=0;return d._addAlgorithm((function(e,t,r){var i=e.key;if("string"!==typeof i)return!1;var h=o(i);if(n(h,s,p))return!0;for(var d=null,y=p;y<f;++y){var v=bt(i,h,a[y],s[y],u,c);null===v&&null===d?p=y+1:(null===d||u(d,v)>0)&&(d=v)}return t(null!==d?function(){e.continue(d+l)}:r),!1})),d}function wt(e,n,t,r){return{type:2,lower:e,upper:n,lowerOpen:t,upperOpen:r}}function xt(e){return{type:1,lower:e,upper:e}}var kt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,n,t,r){t=!1!==t,r=!0===r;try{return this._cmp(e,n)>0||0===this._cmp(e,n)&&(t||r)&&(!t||!r)?vt(this):new this.Collection(this,(function(){return wt(e,n,!t,!r)}))}catch(i){return yt(this,Bn)}},e.prototype.equals=function(e){return null==e?yt(this,Bn):new this.Collection(this,(function(){return xt(e)}))},e.prototype.above=function(e){return null==e?yt(this,Bn):new this.Collection(this,(function(){return wt(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?yt(this,Bn):new this.Collection(this,(function(){return wt(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?yt(this,Bn):new this.Collection(this,(function(){return wt(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?yt(this,Bn):new this.Collection(this,(function(){return wt(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!==typeof e?yt(this,Tn):this.between(e,e+In,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):_t(this,(function(e,n){return 0===e.indexOf(n[0])}),[e],In)},e.prototype.equalsIgnoreCase=function(e){return _t(this,(function(e,n){return e===n[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=L.apply(q,arguments);return 0===e.length?vt(this):_t(this,(function(e,n){return-1!==n.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=L.apply(q,arguments);return 0===e.length?vt(this):_t(this,(function(e,n){return n.some((function(n){return 0===e.indexOf(n)}))}),e,In)},e.prototype.anyOf=function(){var e=this,n=L.apply(q,arguments),t=this._cmp;try{n.sort(t)}catch(o){return yt(this,Bn)}if(0===n.length)return vt(this);var r=new this.Collection(this,(function(){return wt(n[0],n[n.length-1])}));r._ondirectionchange=function(r){t="next"===r?e._ascending:e._descending,n.sort(t)};var i=0;return r._addAlgorithm((function(e,r,o){var u=e.key;while(t(u,n[i])>0)if(++i,i===n.length)return r(o),!1;return 0===t(u,n[i])||(r((function(){e.continue(n[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[Dn,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=L.apply(q,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(t){return yt(this,Bn)}var n=e.reduce((function(e,n){return e?e.concat([[e[e.length-1][1],n]]):[[Dn,n]]}),null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,n){var t=this,r=this._cmp,i=this._ascending,o=this._descending,u=this._min,a=this._max;if(0===e.length)return vt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return yt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);var s=!n||!1!==n.includeLowers,c=n&&!0===n.includeUppers;function l(e,n){for(var t=0,i=e.length;t<i;++t){var o=e[t];if(r(n[0],o[1])<0&&r(n[1],o[0])>0){o[0]=u(o[0],n[0]),o[1]=a(o[1],n[1]);break}}return t===i&&e.push(n),e}var f,h=i;function d(e,n){return h(e[0],n[0])}try{f=e.reduce(l,[]),f.sort(d)}catch(_){return yt(this,Bn)}var p=0,y=c?function(e){return i(e,f[p][1])>0}:function(e){return i(e,f[p][1])>=0},v=s?function(e){return o(e,f[p][0])>0}:function(e){return o(e,f[p][0])>=0};function m(e){return!y(e)&&!v(e)}var g=y,b=new this.Collection(this,(function(){return wt(f[0][0],f[f.length-1][1],!s,!c)}));return b._ondirectionchange=function(e){"next"===e?(g=y,h=i):(g=v,h=o),f.sort(d)},b._addAlgorithm((function(e,n,r){var o=e.key;while(g(o))if(++p,p===f.length)return n(r),!1;return!!m(o)||(0===t._cmp(o,f[p][1])||0===t._cmp(o,f[p][0])||n((function(){h===i?e.continue(f[p][0]):e.continue(f[p][1])})),!1)})),b},e.prototype.startsWithAnyOf=function(){var e=L.apply(q,arguments);return e.every((function(e){return"string"===typeof e}))?0===e.length?vt(this):this.inAnyRange(e.map((function(e){return[e,e+In]}))):yt(this,"startsWithAnyOf() only works with strings")},e}();function Et(e){return Qn(kt.prototype,(function(n,t,r){this.db=e,this._ctx={table:n,index:":id"===t?null:t,or:r};var i=e._deps.indexedDB;if(!i)throw new oe.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(e,n){return i.cmp(n,e)},this._max=function(e,n){return i.cmp(e,n)>0?e:n},this._min=function(e,n){return i.cmp(e,n)<0?e:n},this._IDBKeyRange=e._deps.IDBKeyRange}))}function Pt(e){return sn((function(n){return Kt(n),e(n.target.error),!1}))}function Kt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ot="storagemutated",St="x-storagemutated-1",At=Hn(null,Ot),Ct=function(){function e(){}return e.prototype._lock=function(){return w(!Ne.global),++this._reculock,1!==this._reculock||Ne.global||(Ne.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!Ne.global),0===--this._reculock){Ne.global||(Ne.lockOwnerFor=null);while(this._blockedFuncs.length>0&&!this._locked()){var e=this._blockedFuncs.shift();try{kn(e[1],e[0])}catch(n){}}}return this},e.prototype._locked=function(){return this._reculock&&Ne.lockOwnerFor!==this},e.prototype.create=function(e){var n=this;if(!this.mode)return this;var t=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(r);case"MissingAPIError":throw new oe.MissingAPI(r.message,r);default:throw new oe.OpenFailed(r)}if(!this.active)throw new oe.TransactionInactive;return w(null===this._completion._state),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=sn((function(t){Kt(t),n._reject(e.error)})),e.onabort=sn((function(t){Kt(t),n.active&&n._reject(new oe.Abort(e.error)),n.active=!1,n.on("abort").fire(t)})),e.oncomplete=sn((function(){n.active=!1,n._resolve(),"mutatedParts"in e&&At.storagemutated.fire(e["mutatedParts"])})),this},e.prototype._promise=function(e,n,t){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return An(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return An(new oe.TransactionInactive);if(this._locked())return new Ve((function(i,o){r._blockedFuncs.push([function(){r._promise(e,n,t).then(i,o)},Ne])}));if(t)return yn((function(){var e=new Ve((function(e,t){r._lock();var i=n(e,t,r);i&&i.then&&i.then(e,t)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Ve((function(e,t){var i=n(e,t,r);i&&i.then&&i.then(e,t)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var n=this._root(),t=Ve.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then((function(){return t}));else{n._waitingFor=t,n._waitingQueue=[];var r=n.idbtrans.objectStore(n.storeNames[0]);(function e(){++n._spinCount;while(n._waitingQueue.length)n._waitingQueue.shift()();n._waitingFor&&(r.get(-1/0).onsuccess=e)})()}var i=n._waitingFor;return new Ve((function(e,r){t.then((function(t){return n._waitingQueue.push(sn(e.bind(null,t)))}),(function(e){return n._waitingQueue.push(sn(r.bind(null,e)))})).finally((function(){n._waitingFor===i&&(n._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))},e.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(f(n,e))return n[e];var t=this.schema[e];if(!t)throw new oe.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,t,this);return r.core=this.db.core.table(e),n[e]=r,r},e}();function jt(e){return Qn(Ct.prototype,(function(n,t,r,i,o){var u=this;this.db=e,this.mode=n,this.storeNames=t,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Hn(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ve((function(e,n){u._resolve=e,u._reject=n})),this._completion.then((function(){u.active=!1,u.on.complete.fire()}),(function(e){var n=u.active;return u.active=!1,u.on.error.fire(e),u.parent?u.parent._reject(e):n&&u.idbtrans&&u.idbtrans.abort(),An(e)}))}))}function It(e,n,t,r,i,o,u){return{name:e,keyPath:n,unique:t,multi:r,auto:i,compound:o,src:(t&&!u?"&":"")+(r?"*":"")+(i?"++":"")+Dt(n)}}function Dt(e){return"string"===typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Bt(e,n,t){return{name:e,primKey:n,indexes:t,mappedClass:null,idxByName:k(t,(function(e){return[e.name,e]}))}}function Tt(e){return 1===e.length?e[0]:e}var Rt=function(e){try{return e.only([[]]),Rt=function(){return[[]]},[[]]}catch(n){return Rt=function(){return In},In}};function Ft(e){return null==e?function(){}:"string"===typeof e?Mt(e):function(n){return P(n,e)}}function Mt(e){var n=e.split(".");return 1===n.length?function(n){return n[e]}:function(n){return P(n,e)}}function Nt(e){return[].slice.call(e)}var qt=0;function Lt(e){return null==e?":id":"string"===typeof e?e:"["+e.join("+")+"]"}function Ut(e,n,t){function r(e,n){var t=Nt(e.objectStoreNames);return{schema:{name:e.name,tables:t.map((function(e){return n.objectStore(e)})).map((function(e){var n=e.keyPath,t=e.autoIncrement,r=a(n),i=null==n,o={},u={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:n,autoIncrement:t,unique:!0,extractKey:Ft(n)},indexes:Nt(e.indexNames).map((function(n){return e.index(n)})).map((function(e){var n=e.name,t=e.unique,r=e.multiEntry,i=e.keyPath,u=a(i),s={name:n,compound:u,keyPath:i,unique:t,multiEntry:r,extractKey:Ft(i)};return o[Lt(i)]=s,s})),getIndexByKeyPath:function(e){return o[Lt(e)]}};return o[":id"]=u.primaryKey,null!=n&&(o[Lt(n)]=u.primaryKey),u}))},hasGetAll:t.length>0&&"getAll"in n.objectStore(t[0])&&!("undefined"!==typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen,u=void 0===t?void 0===r?null:n.upperBound(r,!!o):void 0===r?n.lowerBound(t,!!i):n.bound(t,r,!!i,!!o);return u}function o(e){var n=e.name;function t(e){var t=e.trans,r=e.type,o=e.keys,u=e.values,a=e.range;return new Promise((function(e,s){e=sn(e);var c=t.objectStore(n),l=null==c.keyPath,f="put"===r||"add"===r;if(!f&&"delete"!==r&&"deleteRange"!==r)throw new Error("Invalid operation type: "+r);var h,d=(o||u||{length:1}).length;if(o&&u&&o.length!==u.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],y=[],v=0,m=function(e){++v,Kt(e)};if("deleteRange"===r){if(4===a.type)return e({numFailures:v,failures:y,results:[],lastResult:void 0});3===a.type?p.push(h=c.clear()):p.push(h=c.delete(i(a)))}else{var g=f?l?[u,o]:[u,null]:[o,null],b=g[0],_=g[1];if(f)for(var w=0;w<d;++w)p.push(h=_&&void 0!==_[w]?c[r](b[w],_[w]):c[r](b[w])),h.onerror=m;else for(w=0;w<d;++w)p.push(h=c[r](b[w])),h.onerror=m}var x=function(n){var t=n.target.result;p.forEach((function(e,n){return null!=e.error&&(y[n]=e.error)})),e({numFailures:v,failures:y,results:"delete"===r?o:p.map((function(e){return e.result})),lastResult:t})};h.onerror=function(e){m(e),x(e)},h.onsuccess=x}))}function r(e){var t=e.trans,r=e.values,o=e.query,u=e.reverse,a=e.unique;return new Promise((function(e,s){e=sn(e);var c=o.index,l=o.range,f=t.objectStore(n),h=c.isPrimaryKey?f:f.index(c.name),d=u?a?"prevunique":"prev":a?"nextunique":"next",p=r||!("openKeyCursor"in h)?h.openCursor(i(l),d):h.openKeyCursor(i(l),d);p.onerror=Pt(s),p.onsuccess=sn((function(n){var r=p.result;if(r){r.___id=++qt,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var u=r.advance.bind(r),a=function(){throw new Error("Cursor not started")},c=function(){throw new Error("Cursor not stopped")};r.trans=t,r.stop=r.continue=r.continuePrimaryKey=r.advance=a,r.fail=sn(s),r.next=function(){var e=this,n=1;return this.start((function(){return n--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var n=new Promise((function(e,n){e=sn(e),p.onerror=Pt(n),r.fail=n,r.stop=function(n){r.stop=r.continue=r.continuePrimaryKey=r.advance=c,e(n)}})),t=function(){if(p.result)try{e()}catch(n){r.fail(n)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=sn((function(e){p.onsuccess=t,t()})),r.continue=i,r.continuePrimaryKey=o,r.advance=u,t(),n},e(r)}else e(null)}),s)}))}function o(e){return function(t){return new Promise((function(r,o){r=sn(r);var u=t.trans,a=t.values,s=t.limit,c=t.query,l=s===1/0?void 0:s,f=c.index,h=c.range,d=u.objectStore(n),p=f.isPrimaryKey?d:d.index(f.name),y=i(h);if(0===s)return r({result:[]});if(e){var v=a?p.getAll(y,l):p.getAllKeys(y,l);v.onsuccess=function(e){return r({result:e.target.result})},v.onerror=Pt(o)}else{var m=0,g=a||!("openKeyCursor"in p)?p.openCursor(y):p.openKeyCursor(y),b=[];g.onsuccess=function(e){var n=g.result;return n?(b.push(a?n.value:n.primaryKey),++m===s?r({result:b}):void n.continue()):r({result:b})},g.onerror=Pt(o)}}))}}return{name:n,schema:e,mutate:t,getMany:function(e){var t=e.trans,r=e.keys;return new Promise((function(e,i){e=sn(e);for(var o,u=t.objectStore(n),a=r.length,s=new Array(a),c=0,l=0,f=function(n){var t=n.target;s[t._pos]=t.result,++l===c&&e(s)},h=Pt(i),d=0;d<a;++d){var p=r[d];null!=p&&(o=u.get(r[d]),o._pos=d,o.onsuccess=f,o.onerror=h,++c)}0===c&&e(s)}))},get:function(e){var t=e.trans,r=e.key;return new Promise((function(e,i){e=sn(e);var o=t.objectStore(n),u=o.get(r);u.onsuccess=function(n){return e(n.target.result)},u.onerror=Pt(i)}))},query:o(c),openCursor:r,count:function(e){var t=e.query,r=e.trans,o=t.index,u=t.range;return new Promise((function(e,t){var a=r.objectStore(n),s=o.isPrimaryKey?a:a.index(o.name),c=i(u),l=c?s.count(c):s.count();l.onsuccess=sn((function(n){return e(n.target.result)})),l.onerror=Pt(t)}))}}}var u=r(e,t),s=u.schema,c=u.hasGetAll,l=s.tables.map((function(e){return o(e)})),f={};return l.forEach((function(e){return f[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){var n=f[e];if(!n)throw new Error("Table '"+e+"' not found");return f[e]},MIN_KEY:-1/0,MAX_KEY:Rt(n),schema:s}}function Vt(e,n){return n.reduce((function(e,n){var t=n.create;return r(r({},e),t(e))}),e)}function Wt(e,n,t,r){var i=t.IDBKeyRange;t.indexedDB;var o=Vt(Ut(n,i,r),e.dbcore);return{dbcore:o}}function Yt(e,n){var t=e._novip,r=n.db,i=Wt(t._middlewares,r,t._deps,n);t.core=i.dbcore,t.tables.forEach((function(e){var n=e.name;t.core.schema.tables.some((function(e){return e.name===n}))&&(e.core=t.core.table(n),t[n]instanceof t.Table&&(t[n].core=e.core))}))}function zt(e,n,t,r){var i=e._novip;t.forEach((function(e){var t=r[e];n.forEach((function(n){var r=m(n,e);(!r||"value"in r&&void 0===r.value)&&(n===i.Transaction.prototype||n instanceof i.Transaction?p(n,e,{get:function(){return this.table(e)},set:function(n){d(this,e,{value:n,writable:!0,configurable:!0,enumerable:!0})}}):n[e]=new i.Table(e,t))}))}))}function Gt(e,n){var t=e._novip;n.forEach((function(e){for(var n in e)e[n]instanceof t.Table&&delete e[n]}))}function Ht(e,n){return e._cfg.version-n._cfg.version}function Qt(e,n,t,r){var i=e._dbSchema,o=e._createTransaction("readwrite",e._storeNames,i);o.create(t),o._completion.catch(r);var a=o._reject.bind(o),s=Ne.transless||Ne;yn((function(){Ne.trans=o,Ne.transless=s,0===n?(u(i).forEach((function(e){$t(t,e,i[e].primKey,i[e].indexes)})),Yt(e,t),Ve.follow((function(){return e.on.populate.fire(o)})).catch(a)):Xt(e,n,o,t).catch(a)}))}function Xt(e,n,t,r){var i=e._novip,o=[],a=i._versions,s=i._dbSchema=tr(i,i.idbdb,r),c=!1,l=a.filter((function(e){return e._cfg.version>=n}));function f(){return o.length?Ve.resolve(o.shift()(t.idbtrans)).then(f):Ve.resolve()}return l.forEach((function(e){o.push((function(){var o=s,a=e._cfg.dbschema;or(i,o,r),or(i,a,r),s=i._dbSchema=a;var l=Jt(o,a);l.add.forEach((function(e){$t(r,e[0],e[1].primKey,e[1].indexes)})),l.change.forEach((function(e){if(e.recreate)throw new oe.Upgrade("Not yet support for changing primary key");var n=r.objectStore(e.name);e.add.forEach((function(e){return nr(n,e)})),e.change.forEach((function(e){n.deleteIndex(e.name),nr(n,e)})),e.del.forEach((function(e){return n.deleteIndex(e)}))}));var f=e._cfg.contentUpgrade;if(f&&e._cfg.version>n){Yt(i,r),t._memoizedTables={},c=!0;var h=S(a);l.del.forEach((function(e){h[e]=o[e]})),Gt(i,[i.Transaction.prototype]),zt(i,[i.Transaction.prototype],u(h),h),t.schema=h;var d,p=U(f);p&&vn();var y=Ve.follow((function(){if(d=f(t),d&&p){var e=mn.bind(null,null);d.then(e,e)}}));return d&&"function"===typeof d.then?Ve.resolve(d):y.then((function(){return d}))}})),o.push((function(n){if(!c||!Mn){var r=e._cfg.dbschema;er(r,n)}Gt(i,[i.Transaction.prototype]),zt(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),t.schema=i._dbSchema}))})),f().then((function(){Zt(s,r)}))}function Jt(e,n){var t,r={del:[],add:[],change:[]};for(t in e)n[t]||r.del.push(t);for(t in n){var i=e[t],o=n[t];if(i){var u={name:t,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!==""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!Fn)u.recreate=!0,r.change.push(u);else{var a=i.idxByName,s=o.idxByName,c=void 0;for(c in a)s[c]||u.del.push(c);for(c in s){var l=a[c],f=s[c];l?l.src!==f.src&&u.change.push(f):u.add.push(f)}(u.del.length>0||u.add.length>0||u.change.length>0)&&r.change.push(u)}}else r.add.push([t,o])}return r}function $t(e,n,t,r){var i=e.db.createObjectStore(n,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach((function(e){return nr(i,e)})),i}function Zt(e,n){u(e).forEach((function(t){n.db.objectStoreNames.contains(t)||$t(n,t,e[t].primKey,e[t].indexes)}))}function er(e,n){[].slice.call(n.db.objectStoreNames).forEach((function(t){return null==e[t]&&n.db.deleteObjectStore(t)}))}function nr(e,n){e.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function tr(e,n,t){var r={},i=b(n.objectStoreNames,0);return i.forEach((function(e){for(var n=t.objectStore(e),i=n.keyPath,o=It(Dt(i),i||"",!1,!1,!!n.autoIncrement,i&&"string"!==typeof i,!0),u=[],a=0;a<n.indexNames.length;++a){var s=n.index(n.indexNames[a]);i=s.keyPath;var c=It(s.name,i,!!s.unique,!!s.multiEntry,!1,i&&"string"!==typeof i,!1);u.push(c)}r[e]=Bt(e,o,u)})),r}function rr(e,n,t){var r=e._novip;r.verno=n.version/10;var i=r._dbSchema=tr(r,n,t);r._storeNames=b(n.objectStoreNames,0),zt(r,[r._allTables],u(i),i)}function ir(e,n){var t=tr(e,e.idbdb,n),r=Jt(t,e._dbSchema);return!(r.add.length||r.change.some((function(e){return e.add.length||e.change.length})))}function or(e,n,t){for(var r=e._novip,i=t.db.objectStoreNames,u=0;u<i.length;++u){var a=i[u],s=t.objectStore(a);r._hasGetAll="getAll"in s;for(var c=0;c<s.indexNames.length;++c){var l=s.indexNames[c],f=s.index(l).keyPath,h="string"===typeof f?f:"["+b(f).join("+")+"]";if(n[a]){var d=n[a].idxByName[h];d&&(d.name=l,delete n[a].idxByName[h],n[a].idxByName[l]=d)}}}"undefined"!==typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function ur(e){return e.split(",").map((function(e,n){e=e.trim();var t=e.replace(/([&*]|\+\+)/g,""),r=/^\[/.test(t)?t.match(/^\[(.*)\]$/)[1].split("+"):t;return It(t,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===n)}))}var ar=function(){function e(){}return e.prototype._parseStoresSpec=function(e,n){u(e).forEach((function(t){if(null!==e[t]){var r=ur(e[t]),i=r.shift();if(i.multi)throw new oe.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")})),n[t]=Bt(t,i,r)}}))},e.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;var t=n._versions,r={},i={};return t.forEach((function(e){s(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),n._dbSchema=i,Gt(n,[n._allTables,n,n.Transaction.prototype]),zt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],u(i),i),n._storeNames=u(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=me(this._cfg.contentUpgrade||ce,e),this},e}();function sr(e){return Qn(ar.prototype,(function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}function cr(e,n){var t=e["_dbNamesDB"];return t||(t=e["_dbNamesDB"]=new Lr(Ln,{addons:[],indexedDB:e,IDBKeyRange:n}),t.version(1).stores({dbnames:"name"})),t.table("dbnames")}function lr(e){return e&&"function"===typeof e.databases}function fr(e){var n=e.indexedDB,t=e.IDBKeyRange;return lr(n)?Promise.resolve(n.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==Ln}))})):cr(n,t).toCollection().primaryKeys()}function hr(e,n){var t=e.indexedDB,r=e.IDBKeyRange;!lr(t)&&n!==Ln&&cr(t,r).put({name:n}).catch(ce)}function dr(e,n){var t=e.indexedDB,r=e.IDBKeyRange;!lr(t)&&n!==Ln&&cr(t,r).delete(n).catch(ce)}function pr(e){return yn((function(){return Ne.letThrough=!0,e()}))}function yr(){var e,n=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);return n&&indexedDB.databases?new Promise((function(n){var t=function(){return indexedDB.databases().finally(n)};e=setInterval(t,100),t()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function vr(e){var n=e._state,t=e._deps.indexedDB;if(n.isBeingOpened||e.idbdb)return n.dbReadyPromise.then((function(){return n.dbOpenError?An(n.dbOpenError):e}));V&&(n.openCanceller._stackHolder=G()),n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var r=n.openCanceller;function i(){if(n.openCanceller!==r)throw new oe.DatabaseClosed("db.open() was cancelled")}var o=n.dbReadyResolve,u=null,a=!1;return Ve.race([r,("undefined"===typeof navigator?Ve.resolve():yr()).then((function(){return new Ve((function(r,o){if(i(),!t)throw new oe.MissingAPI;var s=e.name,c=n.autoSchema?t.open(s):t.open(s,Math.round(10*e.verno));if(!c)throw new oe.MissingAPI;c.onerror=Pt(o),c.onblocked=sn(e._fireOnBlocked),c.onupgradeneeded=sn((function(r){if(u=c.transaction,n.autoSchema&&!e._options.allowEmptyDB){c.onerror=Kt,u.abort(),c.result.close();var i=t.deleteDatabase(s);i.onsuccess=i.onerror=sn((function(){o(new oe.NoSuchDatabase("Database "+s+" doesnt exist"))}))}else{u.onerror=Pt(o);var l=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;a=l<1,e._novip.idbdb=c.result,Qt(e,l/10,u,o)}}),o),c.onsuccess=sn((function(){u=null;var t=e._novip.idbdb=c.result,i=b(t.objectStoreNames);if(i.length>0)try{var o=t.transaction(Tt(i),"readonly");n.autoSchema?rr(e,t,o):(or(e,e._dbSchema,o),ir(e,o)),Yt(e,o)}catch(l){}Rn.push(e),t.onversionchange=sn((function(t){n.vcFired=!0,e.on("versionchange").fire(t)})),t.onclose=sn((function(n){e.on("close").fire(n)})),a&&hr(e._deps,s),r()}),o)}))}))]).then((function(){return i(),n.onReadyBeingFired=[],Ve.resolve(pr((function(){return e.on.ready.fire(e.vip)}))).then((function t(){if(n.onReadyBeingFired.length>0){var r=n.onReadyBeingFired.reduce(me,ce);return n.onReadyBeingFired=[],Ve.resolve(pr((function(){return r(e.vip)}))).then(t)}}))})).finally((function(){n.onReadyBeingFired=null,n.isBeingOpened=!1})).then((function(){return e})).catch((function(t){n.dbOpenError=t;try{u&&u.abort()}catch(Sr){}return r===n.openCanceller&&e._close(),An(t)})).finally((function(){n.openComplete=!0,o()}))}function mr(e){var n=function(n){return e.next(n)},t=function(n){return e.throw(n)},r=o(n),i=o(t);function o(e){return function(n){var t=e(n),o=t.value;return t.done?o:o&&"function"===typeof o.then?o.then(r,i):a(o)?Promise.all(o).then(r,i):r(o)}}return o(n)()}function gr(e,n,t){var r=arguments.length;if(r<2)throw new oe.InvalidArgument("Too few arguments");var i=new Array(r-1);while(--r)i[r-1]=arguments[r];t=i.pop();var o=C(i);return[e,o,t]}function br(e,n,t,r,i){return Ve.resolve().then((function(){var o=Ne.transless||Ne,u=e._createTransaction(n,t,e._dbSchema,r),a={trans:u,transless:o};if(r)u.idbtrans=r.idbtrans;else try{u.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===re.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(e._close(),e.open().then((function(){return br(e,n,t,null,i)}))):An(f)}var s,c=U(i);c&&vn();var l=Ve.follow((function(){if(s=i.call(u,u),s)if(c){var e=mn.bind(null,null);s.then(e,e)}else"function"===typeof s.next&&"function"===typeof s.throw&&(s=mr(s))}),a);return(s&&"function"===typeof s.then?Ve.resolve(s).then((function(e){return u.active?e:An(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return s}))).then((function(e){return r&&u._resolve(),u._completion.then((function(){return e}))})).catch((function(e){return u._reject(e),An(e)}))}))}function _r(e,n,t){for(var r=a(e)?e.slice():[e],i=0;i<t;++i)r.push(n);return r}function wr(e){return r(r({},e),{table:function(n){var t=e.table(n),i=t.schema,o={},u=[];function a(e,n,t){var i=Lt(e),s=o[i]=o[i]||[],c=null==e?0:"string"===typeof e?1:e.length,l=n>0,f=r(r({},t),{isVirtual:l,keyTail:n,keyLength:c,extractKey:Ft(e),unique:!l&&t.unique});if(s.push(f),f.isPrimaryKey||u.push(f),c>1){var h=2===c?e[0]:e.slice(0,c-1);a(h,n+1,t)}return s.sort((function(e,n){return e.keyTail-n.keyTail})),f}var s=a(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[s];for(var c=0,l=i.indexes;c<l.length;c++){var f=l[c];a(f.keyPath,0,f)}function h(e){var n=o[Lt(e)];return n&&n[0]}function d(n,t){return{type:1===n.type?2:n.type,lower:_r(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,t),lowerOpen:!0,upper:_r(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,t),upperOpen:!0}}function p(e){var n=e.query.index;return n.isVirtual?r(r({},e),{query:{index:n,range:d(e.query.range,n.keyTail)}}):e}var y=r(r({},t),{schema:r(r({},i),{primaryKey:s,indexes:u,getIndexByKeyPath:h}),count:function(e){return t.count(p(e))},query:function(e){return t.query(p(e))},openCursor:function(n){var r=n.query.index,i=r.keyTail,o=r.isVirtual,u=r.keyLength;if(!o)return t.openCursor(n);function a(t){function r(r){null!=r?t.continue(_r(r,n.reverse?e.MAX_KEY:e.MIN_KEY,i)):n.unique?t.continue(t.key.slice(0,u).concat(n.reverse?e.MIN_KEY:e.MAX_KEY,i)):t.continue()}var o=Object.create(t,{continue:{value:r},continuePrimaryKey:{value:function(n,r){t.continuePrimaryKey(_r(n,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return t.primaryKey}},key:{get:function(){var e=t.key;return 1===u?e[0]:e.slice(0,u)}},value:{get:function(){return t.value}}});return o}return t.openCursor(p(n)).then((function(e){return e&&a(e)}))}});return y}})}var xr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:wr};function kr(e,n,t,r){return t=t||{},r=r||"",u(e).forEach((function(i){if(f(n,i)){var o=e[i],u=n[i];if("object"===typeof o&&"object"===typeof u&&o&&u){var a=F(o),s=F(u);a!==s?t[r+i]=n[i]:"Object"===a?kr(o,u,t,r+i+"."):o!==u&&(t[r+i]=n[i])}else o!==u&&(t[r+i]=n[i])}else t[r+i]=void 0})),u(n).forEach((function(i){f(e,i)||(t[r+i]=n[i])})),t}function Er(e,n){return"delete"===n.type?n.keys:n.keys||n.values.map(e.extractKey)}var Pr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(n){var t=e.table(n),o=t.schema.primaryKey,u=r(r({},t),{mutate:function(e){var u=Ne.trans,a=u.table(n).hook,s=a.deleting,c=a.creating,l=a.updating;switch(e.type){case"add":if(c.fire===ce)break;return u._promise("readwrite",(function(){return h(e)}),!0);case"put":if(c.fire===ce&&l.fire===ce)break;return u._promise("readwrite",(function(){return h(e)}),!0);case"delete":if(s.fire===ce)break;return u._promise("readwrite",(function(){return h(e)}),!0);case"deleteRange":if(s.fire===ce)break;return u._promise("readwrite",(function(){return d(e)}),!0)}return t.mutate(e);function h(e){var n=Ne.trans,u=e.keys||Er(o,e);if(!u)throw new Error("Keys missing");return e="add"===e.type||"put"===e.type?r(r({},e),{keys:u}):r({},e),"delete"!==e.type&&(e.values=i([],e.values,!0)),e.keys&&(e.keys=i([],e.keys,!0)),Kr(t,e,u).then((function(r){var i=u.map((function(t,i){var u=r[i],a={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(a,t,u,n);else if("add"===e.type||void 0===u){var h=c.fire.call(a,t,e.values[i],n);null==t&&null!=h&&(t=h,e.keys[i]=t,o.outbound||K(e.values[i],o.keyPath,t))}else{var d=kr(u,e.values[i]),p=l.fire.call(a,d,t,u,n);if(p){var y=e.values[i];Object.keys(p).forEach((function(e){f(y,e)?y[e]=p[e]:K(y,e,p[e])}))}}return a}));return t.mutate(e).then((function(n){for(var t=n.failures,o=n.results,a=n.numFailures,s=n.lastResult,c=0;c<u.length;++c){var l=o?o[c]:u[c],f=i[c];null==l?f.onerror&&f.onerror(t[c]):f.onsuccess&&f.onsuccess("put"===e.type&&r[c]?e.values[c]:l)}return{failures:t,results:o,numFailures:a,lastResult:s}})).catch((function(e){return i.forEach((function(n){return n.onerror&&n.onerror(e)})),Promise.reject(e)}))}))}function d(e){return p(e.trans,e.range,1e4)}function p(e,n,i){return t.query({trans:e,values:!1,query:{index:o,range:n},limit:i}).then((function(t){var o=t.result;return h({type:"delete",keys:o,trans:e}).then((function(t){return t.numFailures>0?Promise.reject(t.failures[0]):o.length<i?{failures:[],numFailures:0,lastResult:void 0}:p(e,r(r({},n),{lower:o[o.length-1],lowerOpen:!0}),i)}))}))}}});return u}})}};function Kr(e,n,t){return"add"===n.type?Promise.resolve([]):e.getMany({trans:n.trans,keys:t,cache:"immutable"})}function Or(e,n,t){try{if(!n)return null;if(n.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<n.keys.length&&o<e.length;++i)0===ot(n.keys[i],e[o])&&(r.push(t?B(n.values[i]):n.values[i]),++o);return r.length===e.length?r:null}catch(Sr){return null}}var Sr,Ar={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var t=e.table(n);return r(r({},t),{getMany:function(e){if(!e.cache)return t.getMany(e);var n=Or(e.keys,e.trans["_cache"],"clone"===e.cache);return n?Ve.resolve(n):t.getMany(e).then((function(n){return e.trans["_cache"]={keys:e.keys,values:"clone"===e.cache?B(n):n},n}))},mutate:function(e){return"add"!==e.type&&(e.trans["_cache"]=null),t.mutate(e)}})}}}};function Cr(e){return!("from"in e)}var jr=function(e,n){if(!this){var t=new jr;return e&&"d"in e&&s(t,e),t}s(this,arguments.length?{d:1,from:e,to:arguments.length>1?n:e}:{d:0})};function Ir(e,n,t){var r=ot(n,t);if(!isNaN(r)){if(r>0)throw RangeError();if(Cr(e))return s(e,{from:n,to:t,d:1});var i=e.l,o=e.r;if(ot(t,e.from)<0)return i?Ir(i,n,t):e.l={from:n,to:t,d:1,l:null,r:null},Rr(e);if(ot(n,e.to)>0)return o?Ir(o,n,t):e.r={from:n,to:t,d:1,l:null,r:null},Rr(e);ot(n,e.from)<0&&(e.from=n,e.l=null,e.d=o?o.d+1:1),ot(t,e.to)>0&&(e.to=t,e.r=null,e.d=e.l?e.l.d+1:1);var u=!e.r;i&&!e.l&&Dr(e,i),o&&u&&Dr(e,o)}}function Dr(e,n){function t(e,n){var r=n.from,i=n.to,o=n.l,u=n.r;Ir(e,r,i),o&&t(e,o),u&&t(e,u)}Cr(n)||t(e,n)}function Br(e,n){var t=Tr(n),r=t.next();if(r.done)return!1;var i=r.value,o=Tr(e),u=o.next(i.from),a=u.value;while(!r.done&&!u.done){if(ot(a.from,i.to)<=0&&ot(a.to,i.from)>=0)return!0;ot(i.from,a.from)<0?i=(r=t.next(a.from)).value:a=(u=o.next(i.from)).value}return!1}function Tr(e){var n=Cr(e)?null:{s:0,n:e};return{next:function(e){var t=arguments.length>0;while(n)switch(n.s){case 0:if(n.s=1,t)while(n.n.l&&ot(e,n.n.from)<0)n={up:n,n:n.n.l,s:1};else while(n.n.l)n={up:n,n:n.n.l,s:1};case 1:if(n.s=2,!t||ot(e,n.n.to)<=0)return{value:n.n,done:!1};case 2:if(n.n.r){n.s=3,n={up:n,n:n.n.r,s:0};continue}case 3:n=n.up}return{done:!0}}}}function Rr(e){var n,t,i=((null===(n=e.r)||void 0===n?void 0:n.d)||0)-((null===(t=e.l)||void 0===t?void 0:t.d)||0),o=i>1?"r":i<-1?"l":"";if(o){var u="r"===o?"l":"r",a=r({},e),s=e[o];e.from=s.from,e.to=s.to,e[o]=s[o],a[o]=s[u],e[u]=a,a.d=Fr(a)}e.d=Fr(e)}function Fr(e){var n=e.r,t=e.l;return(n?t?Math.max(n.d,t.d):n.d:t?t.d:0)+1}h(jr.prototype,(Sr={add:function(e){return Dr(this,e),this},addKey:function(e){return Ir(this,e,e),this},addKeys:function(e){var n=this;return e.forEach((function(e){return Ir(n,e,e)})),this}},Sr[M]=function(){return Tr(this)},Sr));var Mr={stack:"dbcore",level:0,create:function(e){var n=e.schema.name,t=new jr(e.MIN_KEY,e.MAX_KEY);return r(r({},e),{table:function(i){var o=e.table(i),s=o.schema,c=s.primaryKey,l=c.extractKey,f=c.outbound,h=r(r({},o),{mutate:function(e){var r=e.trans,u=r.mutatedParts||(r.mutatedParts={}),c=function(e){var t="idb://"+n+"/"+i+"/"+e;return u[t]||(u[t]=new jr)},l=c(""),f=c(":dels"),h=e.type,d="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[],p=d[0],y=d[1],v=e.trans["_cache"];return o.mutate(e).then((function(e){if(a(p)){"delete"!==h&&(p=e.results),l.addKeys(p);var n=Or(p,v);n||"add"===h||f.addKeys(p),(n||y)&&Nr(c,s,n,y)}else if(p){var r={from:p.lower,to:p.upper};f.add(r),l.add(r)}else l.add(t),f.add(t),s.indexes.forEach((function(e){return c(e.name).add(t)}));return e}))}}),d=function(n){var t,r,i=n.query,o=i.index,u=i.range;return[o,new jr(null!==(t=u.lower)&&void 0!==t?t:e.MIN_KEY,null!==(r=u.upper)&&void 0!==r?r:e.MAX_KEY)]},p={get:function(e){return[c,new jr(e.key)]},getMany:function(e){return[c,(new jr).addKeys(e.keys)]},count:d,query:d,openCursor:d};return u(p).forEach((function(e){h[e]=function(u){var a=Ne.subscr;if(a){var s=function(e){var t="idb://"+n+"/"+i+"/"+e;return a[t]||(a[t]=new jr)},c=s(""),h=s(":dels"),d=p[e](u),y=d[0],v=d[1];if(s(y.name||"").add(v),!y.isPrimaryKey){if("count"!==e){var m="query"===e&&f&&u.values&&o.query(r(r({},u),{values:!1}));return o[e].apply(this,arguments).then((function(n){if("query"===e){if(f&&u.values)return m.then((function(e){var t=e.result;return c.addKeys(t),n}));var t=u.values?n.result.map(l):n.result;u.values?c.addKeys(t):h.addKeys(t)}else if("openCursor"===e){var r=n,i=u.values;return r&&Object.create(r,{key:{get:function(){return h.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return h.addKey(e),e}},value:{get:function(){return i&&c.addKey(r.primaryKey),r.value}}})}return n}))}h.add(t)}}return o[e].apply(this,arguments)}})),h}})}};function Nr(e,n,t,r){function i(n){var i=e(n.name||"");function o(e){return null!=e?n.extractKey(e):null}var u=function(e){return n.multiEntry&&a(e)?e.forEach((function(e){return i.addKey(e)})):i.addKey(e)};(t||r).forEach((function(e,n){var i=t&&o(t[n]),a=r&&o(r[n]);0!==ot(i,a)&&(null!=i&&u(i),null!=a&&u(a))}))}n.indexes.forEach(i)}var qr,Lr=function(){function e(n,t){var i=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=t=r({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};var u=t.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ce,dbReadyPromise:null,cancelOpen:ce,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};a.dbReadyPromise=new Ve((function(e){a.dbReadyResolve=e})),a.openCanceller=new Ve((function(e,n){a.cancelOpen=n})),this._state=a,this.name=n,this.on=Hn(this,"populate","blocked","versionchange","close",{ready:[me,ce]}),this.on.ready.subscribe=_(this.on.ready.subscribe,(function(n){return function(t,r){e.vip((function(){var e=i._state;if(e.openComplete)e.dbOpenError||Ve.resolve().then(t),r&&n(t);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(t),r&&n(t);else{n(t);var o=i;r||n((function e(){o.on.ready.unsubscribe(t),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=ht(this),this.Table=Xn(this),this.Transaction=jt(this),this.Version=sr(this),this.WhereClause=Et(this),this.on("versionchange",(function(e){e.newVersion,i.close()})),this.on("blocked",(function(e){!e.newVersion||(e.newVersion,e.oldVersion)})),this._maxKey=Rt(t.IDBKeyRange),this._createTransaction=function(e,n,t,r){return new i.Transaction(e,n,t,i._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),Rn.filter((function(e){return e.name===i.name&&e!==i&&!e._state.vcFired})).map((function(n){return n.on("versionchange").fire(e)}))},this.use(xr),this.use(Pr),this.use(Mr),this.use(Ar),this.vip=Object.create(this,{_vip:{value:!0}}),u.forEach((function(e){return e(i)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new oe.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,t=n.filter((function(n){return n._cfg.version===e}))[0];return t||(t=new this.Version(e),n.push(t),n.sort(Ht),t.stores({}),this._state.autoSchema=!1,t)},e.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||Ne.letThrough||this._vip)?e():new Ve((function(e,t){if(n._state.openComplete)return t(new oe.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen)return void t(new oe.DatabaseClosed);n.open().catch(ce)}n._state.dbReadyPromise.then(e,t)})).then(e)},e.prototype.use=function(e){var n=e.stack,t=e.create,r=e.level,i=e.name;i&&this.unuse({stack:n,name:i});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:t,level:null==r?10:r,name:i}),o.sort((function(e,n){return e.level-n.level})),this},e.prototype.unuse=function(e){var n=e.stack,t=e.name,r=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter((function(e){return r?e.create!==r:!!t&&e.name!==t}))),this},e.prototype.open=function(){return vr(this)},e.prototype._close=function(){var e=this._state,n=Rn.indexOf(this);if(n>=0&&Rn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch(t){}this._novip.idbdb=null}e.dbReadyPromise=new Ve((function(n){e.dbReadyResolve=n})),e.openCanceller=new Ve((function(n,t){e.cancelOpen=t}))},e.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new oe.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},e.prototype.delete=function(){var e=this,n=arguments.length>0,t=this._state;return new Ve((function(r,i){var o=function(){e.close();var n=e._deps.indexedDB.deleteDatabase(e.name);n.onsuccess=sn((function(){dr(e._deps,e.name),r()})),n.onerror=Pt(i),n.onblocked=e._fireOnBlocked};if(n)throw new oe.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(o):o()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return u(this._allTables).map((function(n){return e._allTables[n]}))},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=gr.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,n,t){var r=this,i=Ne.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,u,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(u=n.map((function(e){var n=e instanceof r.Table?e.name:e;if("string"!==typeof n)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return n})),"r"==e||e===Un)o=Un;else{if("rw"!=e&&e!=Vn)throw new oe.InvalidArgument("Invalid transaction mode: "+e);o=Vn}if(i){if(i.mode===Un&&o===Vn){if(!a)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&u.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!a)throw new oe.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),a&&i&&!i.active&&(i=null)}}catch(c){return i?i._promise(null,(function(e,n){n(c)})):An(c)}var s=br.bind(null,this,o,u,i,t);return i?i._promise(o,s,"lock"):Ne.trans?kn(Ne.transless,(function(){return r._whenReady(s)})):this._whenReady(s)},e.prototype.table=function(e){if(!f(this._allTables,e))throw new oe.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Ur="undefined"!==typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",Vr=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,n,t){return this._subscribe(e&&"function"!==typeof e?e:{next:e,error:n,complete:t})},e.prototype[Ur]=function(){return this},e}();function Wr(e,n){return u(n).forEach((function(t){var r=e[t]||(e[t]=new jr);Dr(r,n[t])})),e}function Yr(e){return new Vr((function(n){var t=U(e);function r(n){t&&vn();var r=function(){return yn(e,{subscr:n,trans:null})},i=Ne.trans?kn(Ne.transless,r):r();return t&&i.then(mn,mn),i}var i=!1,o={},a={},s={get closed(){return i},unsubscribe:function(){i=!0,At.storagemutated.unsubscribe(h)}};n.start&&n.start(s);var c=!1,l=!1;function f(){return u(a).some((function(e){return o[e]&&Br(o[e],a[e])}))}var h=function(e){Wr(o,e),f()&&d()},d=function(){if(!c&&!i){o={};var e={},t=r(e);l||(At(Ot,h),l=!0),c=!0,Promise.resolve(t).then((function(t){c=!1,i||(f()?d():(o={},a=e,n.next&&n.next(t)))}),(function(e){c=!1,n.error&&n.error(e),s.unsubscribe()}))}};return d(),s}))}try{qr={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch($r){qr={indexedDB:null,IDBKeyRange:null}}var zr=Lr;function Gr(e){var n=Hr;try{Hr=!0,At.storagemutated.fire(e)}finally{Hr=n}}h(zr,r(r({},se),{delete:function(e){var n=new zr(e,{addons:[]});return n.delete()},exists:function(e){return new zr(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return fr(zr.dependencies).then(e)}catch(Sr){return An(new oe.MissingAPI)}},defineClass:function(){function e(e){s(this,e)}return e},ignoreTransaction:function(e){return Ne.trans?kn(Ne.transless,e):e()},vip:pr,async:function(e){return function(){try{var n=mr(e.apply(this,arguments));return n&&"function"===typeof n.then?n:Ve.resolve(n)}catch($r){return An($r)}}},spawn:function(e,n,t){try{var r=mr(e.apply(t,n||[]));return r&&"function"===typeof r.then?r:Ve.resolve(r)}catch($r){return An($r)}},currentTransaction:{get:function(){return Ne.trans||null}},waitFor:function(e,n){var t=Ve.resolve("function"===typeof e?zr.ignoreTransaction(e):e).timeout(n||6e4);return Ne.trans?Ne.trans.waitFor(t):t},Promise:Ve,debug:{get:function(){return V},set:function(e){W(e,"dexie"===e?function(){return!0}:qn)}},derive:y,extend:s,props:h,override:_,Events:Hn,on:At,liveQuery:Yr,extendObservabilitySet:Wr,getByKeyPath:P,setByKeyPath:K,delByKeyPath:O,shallowClone:S,deepClone:B,getObjectDiff:kr,cmp:ot,asap:x,minKey:Dn,addons:[],connections:Rn,errnames:re,dependencies:qr,semVer:jn,version:jn.split(".").map((function(e){return parseInt(e)})).reduce((function(e,n,t){return e+n/Math.pow(10,2*t)}))})),zr.maxKey=Rt(zr.dependencies.IDBKeyRange),"undefined"!==typeof dispatchEvent&&"undefined"!==typeof addEventListener&&(At(Ot,(function(e){var n;Hr||(Fn?(n=document.createEvent("CustomEvent"),n.initCustomEvent(St,!0,!0,e)):n=new CustomEvent(St,{detail:e}),Hr=!0,dispatchEvent(n),Hr=!1)})),addEventListener(St,(function(e){var n=e.detail;Hr||Gr(n)})));var Hr=!1;if("undefined"!==typeof BroadcastChannel){var Qr=new BroadcastChannel(St);At(Ot,(function(e){Hr||Qr.postMessage(e)})),Qr.onmessage=function(e){e.data&&Gr(e.data)}}else if("undefined"!==typeof self&&"undefined"!==typeof navigator){At(Ot,(function(e){try{Hr||("undefined"!==typeof localStorage&&localStorage.setItem(St,JSON.stringify({trig:Math.random(),changedParts:e})),"object"===typeof self["clients"]&&i([],self["clients"].matchAll({includeUncontrolled:!0}),!0).forEach((function(n){return n.postMessage({type:St,changedParts:e})})))}catch(Sr){}})),"undefined"!==typeof addEventListener&&addEventListener("storage",(function(e){if(e.key===St){var n=JSON.parse(e.newValue);n&&Gr(n.changedParts)}}));var Xr=self.document&&navigator.serviceWorker;Xr&&Xr.addEventListener("message",Jr)}function Jr(e){var n=e.data;n&&n.type===St&&Gr(n.changedParts)}Ve.rejectionMapper=ae,W(V,qn)}}]);